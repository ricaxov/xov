a lot of the stuff contained in here still needs testing and some adjusts
